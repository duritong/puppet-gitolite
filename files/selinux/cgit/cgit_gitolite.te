module cgit_gitolite 1.0;

require {
        type httpd_git_rw_content_t;
        type httpd_git_script_t;
        type ssh_home_t;
        class dir { read write remove_name getattr search open };
        class file { read create getattr execute_no_trans write ioctl unlink open };
        type git_system_t;
        class dir search;
}

#============= httpd_git_script_t ==============
allow httpd_git_script_t httpd_git_rw_content_t:file execute_no_trans;

allow httpd_git_script_t ssh_home_t:dir { write remove_name getattr search };
allow httpd_git_script_t ssh_home_t:file { ioctl read create unlink open getattr };

require {
}

#============= git_system_t ==============
allow git_system_t httpd_git_rw_content_t:dir { read search open getattr };
allow git_system_t httpd_git_rw_content_t:file { read getattr open };

